#include <linkbot.h>
#include <stdio.h>

CLinkbotI robot, robot1;

double r = 1.75;
double trackWidth = 3.69;
double x, y, y1, z;
double distanceBetweenBots;
float challengeNum = 0;
float distanceFromFinishLine;
float randProportion = 0;
int givenProperChallengeNum = 0;

int smooth(int x,int y, int z){
    
robot.setJointSpeeds(x, NaN, y);
robot.driveTime(z);
return 0;    
    }
int main(void){
    while (givenProperChallengeNum == 0)
    {
        printf("Please enter what challenge you would like to perform: ");
        scanf("%f", &challengeNum);
        if(challengeNum > 0 && challengeNum < 12)
        {
            givenProperChallengeNum = 1;
        }
    }
    
    if(challengeNum == 1){
        printf("Enter whole number less than 36: ");
        scanf("%f", &distanceFromFinishLine);
        
        //go forward distance from finish line - 2 inches
        robot.driveDistance(distanceFromFinishLine - 1.5, r);
        
        //pause for a second
        delay(1000);
        
        //go past finish line
        robot.driveDistance(4, r);
        /*//go forward two inches behind finish line
        smooth(200,200,3);
        //pause for a moment
        //go past finish line
        smooth(360, 360, 3);*/
    }   
    else if(challengeNum == 2)
    {
        printf("Enter the random proportion: ");
        scanf("%f", &randProportion);

        robot.driveDistanceNB(36 * randProportion, r);
        robot1.driveDistance((1 - randProportion) * 36, r);
    }
    else if(challengeNum == 3)
    {
        return;
    }
    else if(challengeNum == 4)
    {
        //robot 1 starts driving forward
        robot.driveForeverNB();
        //get speed data for robot 2 - should be basically 0
        robot1.getAccelerometerData(x, y, z);
        //y is baseline, y1 is variable that is being updated
        y1=y;
        
        //while the robot is not moving
        while(abs(y1-y) < 0.03)
        {
            //keep updating accelerometer data for y1
            robot1.getAccelerometerData(x, y1, z);
        }
        //the two bots have collided
        //stop robot 1
        robot.holdJoints();
        //see how far robot 1 traveled
        robot.getDistance(distanceBetweenBots, r);
        //output
        printf("The two robots were %.21f inches apart", distanceBetweenBots);
    }
    else if(challengeNum == 9)
    {    
        smooth(140, 355, 3);
        smooth(360,360, 2);
        smooth(120, 200, 2);
        smooth(360, 360, 4);
        robot.turnLeft(47, r, trackWidth); 
        smooth(360, 360, 4.1);
        smooth(114, 325, 3);
        smooth(360, 360, 7);
    }
}
